---
title: Protobuf Models
expires_at : never
tags: [diego-release, bbs]
---

# Protobuf Models

BBS utilizes [Google's Protobuf Implementation](https://google.golang.org/protobuf) for code generation purposes.
In addition to this, the `protoc-gen-go-bbs` [plugin](../protoc-gen-go-bbs) has been created to accomodate special use cases for BBS itself. 
For example, "raw" protos generated by the `protoc` compiler cannot be passed to functions conventionally due to copylocks, 
so `protoc-gen-go-bbs` generates an additional model that supports this.

> \[!IMPORTANT\]
> New protos MUST be created with the "Proto" prefix on the struct name (e.g. ProtoRunAction) in order to be picked up by the plugin

# Generating models from protobufs

### [Official Documentation](https://protobuf.dev/getting-started/gotutorial/)

## One-step solution for generating all protos
 - Use the `check-proto-files` [script](https://github.com/cloudfoundry/wg-app-platform-runtime-ci/blob/main/diego-release/linters/check-proto-files.bash) 
 from the Working Group CI [repo](https://github.com/cloudfoundry/wg-app-platform-runtime-ci)

## Installation
 - Download the latest `protoc` [compiler](https://github.com/protocolbuffers/protobuf/releases)
 - Unzip and add to PATH
 - Install the latest golang plugin
   - `go install google.golang.org/protobuf/cmd/protoc-gen-go@latest`
 - Install the latest grpc plugin
   - `go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@latest`
 - Install the `protoc-gen-go-bbs` plugin
   - `cd protoc-gen-go-bbs && go install .`

## Usage
### To generate all protos
 - Use the BBS helper [script](../scripts/generate_protos.sh)

### For a single file
 - `protoc --go_out=. --go-grpc_out=. --go_opt=paths=source_relative --go-grpc_opt=paths=source_relative <filename>.proto`
